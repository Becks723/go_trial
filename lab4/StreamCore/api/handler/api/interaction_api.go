// Code generated by hertz generator.

package api

import (
	api "StreamCore/api/model/interaction"
	"StreamCore/api/pack"
	"StreamCore/api/rpc"
	"StreamCore/kitex_gen/interaction"
	"context"

	"github.com/cloudwego/hertz/pkg/app"
)

// PublishLike .
// @router /favorite/action [POST]
func PublishLike(ctx context.Context, c *app.RequestContext) {
	var err error
	var req api.PublishLikeReq
	err = c.BindAndValidate(&req)
	if err != nil {
		pack.RespParamError(c, err)
		return
	}

	resp, err := rpc.PublishLikeRPC(ctx, &interaction.PublishLikeReq{
		VideoId:    req.VideoID,
		CommentId:  req.CommentID,
		ActionType: req.ActionType,
	})
	if err != nil {
		pack.RespRPCError(c, err)
		return
	}

	if !pack.RespBizError(c, resp.Base) {
		pack.RespSuccess(c)
	}
}

// ListLike .
// @router /favorite/list [GET]
func ListLike(ctx context.Context, c *app.RequestContext) {
	var err error
	var req api.ListLikeQuery
	err = c.BindAndValidate(&req)
	if err != nil {
		pack.RespParamError(c, err)
		return
	}

	resp, err := rpc.ListLikeRPC(ctx, &interaction.ListLikeQuery{
		UserId:   req.UserID,
		PageSize: req.PageSize,
		PageNum:  req.PageNum,
	})
	if err != nil {
		pack.RespRPCError(c, err)
		return
	}

	if !pack.RespBizError(c, resp.Base) {
		pack.RespWithData(c, resp.Data)
	}
}

// PublishComment .
// @router /comment/action [POST]
func PublishComment(ctx context.Context, c *app.RequestContext) {
	var err error
	var req api.PublishCommentReq
	err = c.BindAndValidate(&req)
	if err != nil {
		pack.RespParamError(c, err)
		return
	}

	resp, err := rpc.PublishCommentRPC(ctx, &interaction.PublishCommentReq{
		VideoId:   req.VideoID,
		CommentId: req.CommentID,
		Content:   req.Content,
	})
	if err != nil {
		pack.RespRPCError(c, err)
		return
	}

	if !pack.RespBizError(c, resp.Base) {
		pack.RespSuccess(c)
	}
}

// ListComment .
// @router /comment/list [GET]
func ListComment(ctx context.Context, c *app.RequestContext) {
	var err error
	var req api.ListCommentQuery
	err = c.BindAndValidate(&req)
	if err != nil {
		pack.RespParamError(c, err)
		return
	}

	resp, err := rpc.ListCommentRPC(ctx, &interaction.ListCommentQuery{
		VideoId:   req.VideoID,
		CommentId: req.CommentID,
		PageSize:  req.PageSize,
		PageNum:   req.PageNum,
	})
	if err != nil {
		pack.RespRPCError(c, err)
		return
	}

	if !pack.RespBizError(c, resp.Base) {
		pack.RespWithData(c, resp.Data)
	}
}

// DeleteComment .
// @router /comment/delete [DELETE]
func DeleteComment(ctx context.Context, c *app.RequestContext) {
	var err error
	var req api.DeleteCommentReq
	err = c.BindAndValidate(&req)
	if err != nil {
		pack.RespParamError(c, err)
		return
	}

	resp, err := rpc.DeleteCommentRPC(ctx, &interaction.DeleteCommentReq{
		VideoId:   req.VideoID,
		CommentId: req.CommentID,
	})
	if err != nil {
		pack.RespRPCError(c, err)
		return
	}

	if !pack.RespBizError(c, resp.Base) {
		pack.RespSuccess(c)
	}
}
